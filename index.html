<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Flow - Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide-react@latest/dist/lucide-react.js"></script>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .hidden {
            display: none;
        }
        .page {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal-overlay {
            animation: fadeIn 0.3s ease-in-out;
        }
        .modal-content {
            animation: slideUp 0.3s ease-in-out;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="root"></div>

    <script type="text/babel">
        // Helper to create Lucide icons
        const Icon = ({ name, color = 'currentColor', size = 20, className = '' }) => {
            if (!window.lucide) return null;
            const LucideIcon = window.lucide[name];
            return LucideIcon ? React.createElement(LucideIcon, { color, size, className }) : null;
        };
        
        // Simple SVG Logo Component
        const Logo = () => (
            <div className="flex items-center space-x-2">
                <svg width="32" height="32" viewBox="0 0 24 24" className="text-blue-600" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 4L19 8L15 12" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                    <path d="M9 20L5 16L9 12" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                </svg>
                <span className="text-2xl font-bold text-slate-800">Code Flow</span>
            </div>
        );


        // Main App Component
        const App = () => {
            const [page, setPage] = React.useState('home');
            const [isLoading, setIsLoading] = React.useState(false);

            const handleLogin = (e) => {
                e.preventDefault();
                setIsLoading(true);
                setTimeout(() => {
                    setIsLoading(false);
                    setPage('dashboard');
                }, 1500);
            };
            
            const handleLogout = () => {
                setPage('home');
            };

            const navigate = (targetPage) => {
                if(targetPage === 'login') setPage('login');
                else if (targetPage === 'home') setPage('home');
            };

            return (
                <div>
                    {page === 'home' && <HomePage onNavigate={navigate} />}
                    {page === 'login' && <LoginPage onLogin={handleLogin} isLoading={isLoading} />}
                    {page === 'dashboard' && <DashboardPage onLogout={handleLogout} />}
                </div>
            );
        };

        // Component for the public-facing Company Homepage
        const HomePage = ({ onNavigate }) => {
            const teamMembers = [
                { name: "Mayank Kaushik", role: "Founder & Project Manager", image: "https://easy-peasy.ai/cdn-cgi/image/quality=80,format=auto,width=700/https://media.easy-peasy.ai/18fafc59-b8f8-4cfd-adb0-ebda9da48e03/4721eea8-03cf-4935-aa3d-0e74bdd2d034.png" },
                { name: "Prince Suthar", role: "Full Stack Developer", image: "https://i.ibb.co/PvsyVNZq/prince.jpg" }
            ];

            return (
                <div className="page">
                    <header className="bg-white shadow-sm sticky top-0 z-50">
                        <div className="container mx-auto px-6 py-4 flex justify-between items-center">
                            <Logo />
                            <nav className="hidden md:flex items-center space-x-6">
                                <a href="#" className="text-slate-600 hover:text-blue-600 transition-colors">Home</a>
                                <a href="#" className="text-slate-600 hover:text-blue-600 transition-colors">Services</a>
                                <a href="#" className="text-slate-600 hover:text-blue-600 transition-colors">Our Work</a>
                                <a href="#" className="text-slate-600 hover:text-blue-600 transition-colors">Contact</a>
                            </nav>
                            <button onClick={() => onNavigate('login')} className="bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                Employee Login
                            </button>
                        </div>
                    </header>
                    <main className="container mx-auto px-6 py-16 md:py-24 text-center">
                        <h1 className="text-4xl md:text-6xl font-bold text-slate-900 leading-tight">Crafting Digital Excellence, One Line at a Time.</h1>
                        <p className="mt-6 text-lg text-slate-600 max-w-2xl mx-auto">We transform complex problems into elegant, high-performance digital solutions that power the future of the web.</p>
                        <button onClick={() => onNavigate('login')} className="mt-8 bg-blue-600 text-white font-bold px-8 py-3 rounded-lg text-lg hover:bg-blue-700 transition-transform hover:scale-105">
                            View My Dashboard
                        </button>
                    </main>
                    <section className="bg-white py-20">
                        <div className="container mx-auto px-6">
                            <h2 className="text-3xl font-bold text-center text-slate-800 mb-12">Our Expertise</h2>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                <div className="bg-slate-50 p-8 rounded-xl text-center hover:shadow-lg hover:scale-105 transition-all">
                                    <h3 className="text-xl font-semibold mb-2">Frontend Development</h3>
                                    <p className="text-slate-600">Building beautiful, responsive, and blazing-fast user interfaces with modern frameworks.</p>
                                </div>
                                <div className="bg-slate-50 p-8 rounded-xl text-center hover:shadow-lg hover:scale-105 transition-all">
                                    <h3 className="text-xl font-semibold mb-2">Backend Development</h3>
                                    <p className="text-slate-600">Engineering robust, scalable, and secure server-side logic and APIs.</p>
                                </div>
                                <div className="bg-slate-50 p-8 rounded-xl text-center hover:shadow-lg hover:scale-105 transition-all">
                                    <h3 className="text-xl font-semibold mb-2">UI/UX & Web Design</h3>
                                    <p className="text-slate-600">Designing intuitive and pixel-perfect user experiences that delight users.</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section className="py-20">
                         <div className="container mx-auto px-6">
                            <h2 className="text-3xl font-bold text-center text-slate-800 mb-12">Meet The Team</h2>
                             <div className="flex flex-col md:flex-row justify-center gap-12">
                                {teamMembers.map(member => (
                                    <div key={member.name} className="text-center">
                                        <img src={member.image} alt={member.name} className="w-32 h-32 rounded-full mx-auto mb-4 object-cover ring-4 ring-white shadow-lg" />
                                        <h3 className="text-xl font-semibold mt-2">{member.name}</h3>
                                        <p className="text-slate-600">{member.role}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>
                    <footer className="bg-slate-800 text-white py-8">
                        <div className="container mx-auto px-6 text-center">
                            <p>&copy; 2025 Code Flow. All rights reserved.</p>
                            <p className="text-sm text-slate-400 mt-1">Gurgaon, Haryana, India</p>
                        </div>
                    </footer>
                </div>
            );
        };

        const LoginPage = ({ onLogin, isLoading }) => {
            const [showPassword, setShowPassword] = React.useState(false);
            return (
                <div className="page min-h-screen flex items-center justify-center bg-slate-100 p-4">
                    <div className="w-full max-w-sm mx-auto">
                         <div className="flex justify-center mb-6">
                            <Logo />
                        </div>
                        <div className="bg-white p-8 rounded-xl shadow-lg">
                            <h2 className="text-2xl font-bold text-center text-slate-800">Employee Portal</h2>
                            <p className="text-center text-slate-500 mt-2 text-sm">Access your personal dashboard.</p>
                            <form className="mt-8 space-y-6" onSubmit={onLogin}>
                                <div>
                                    <label htmlFor="username" className="text-sm font-medium text-slate-700">Username</label>
                                    <input id="username" name="username" type="text" required className="mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" placeholder="prince.suthar" defaultValue="prince.suthar" />
                                </div>
                                <div className="relative">
                                    <label htmlFor="password" className="text-sm font-medium text-slate-700">Password</label>
                                    <input id="password" name="password" type={showPassword ? 'text' : 'password'} required className="mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" placeholder="••••••••" defaultValue="password" />
                                    <button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute inset-y-0 right-0 top-6 pr-3 flex items-center text-slate-500 hover:text-slate-700">
                                        <Icon name={showPassword ? 'EyeOff' : 'Eye'} size={20} />
                                    </button>
                                </div>
                                <div className="text-right text-sm">
                                    <a href="#" className="font-medium text-blue-600 hover:text-blue-500">Forgot password?</a>
                                </div>
                                <button type="submit" disabled={isLoading} className="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 flex items-center justify-center">
                                    {isLoading ? ( <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div> ) : ( 'Login Securely' )}
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        };

        const DashboardPage = ({ onLogout }) => {
            const [activeView, setActiveView] = React.useState('dashboard');
            const [isSidebarOpen, setSidebarOpen] = React.useState(false);
            const [modal, setModal] = React.useState({ type: null, isOpen: false });
            
            const [userDetails, setUserDetails] = React.useState({
                name: "Prince Suthar",
                role: "Full Stack Developer & Web Designer",
                email: "cluecode.prince@gmail.com",
                phone: "+91 9992780243", employeeId: "CF-001",
                avatar: "https://i.ibb.co/PvsyVNZq/prince.jpg",
                about: "A results-driven Full Stack Developer specializing in creating high-performance, scalable web applications. With a passion for clean architecture and user-centric design, I architect and build complete digital experiences, from robust backend APIs to seamless, responsive frontend interfaces. My expertise lies in translating complex requirements into elegant, efficient, and maintainable code.",
                skills: [ { name: "Next.js & React.js", level: 98 }, { name: "Node.js & Express", level: 95 }, { name: "TypeScript", level: 92 }, { name: "Database (SQL/NoSQL)", level: 94 }, { name: "UI/UX Design (Figma)", level: 90 }, ],
                workload: [
                    { id: 1, name: "UrbanCart - E-commerce Frontend", status: "In Progress", statusColor: "amber", due: "July 28, 2025", progress: 15 },
                    { id: 2, name: "ApnaConnect - Social Media API", status: "New", statusColor: "blue", due: "August 20, 2025", progress: 0 },
                    { id: 3, name: "HealthFirst - Clinic Management UI/UX", status: "Paused", statusColor: "gray", due: "August 05, 2025", progress: 25 },
                ],
                payments: {
                    bankAccount: { name: "State Bank of India", number: "xxxx xxxx 7824" },
                    transactions: [ { id: 1, type: 'debit', description: 'Withdraw to Bank', date: 'Jun 10, 2025', amount: 7350, status: 'Completed' }, { id: 2, type: 'credit', description: 'Advance Recieved', date: 'Jun 10, 2025', amount: 7500, status: 'Completed' }, ],
                    advanceRequests: []
                }
            });

            const handleProjectAction = (projectId, action) => {
                setUserDetails(prev => ({
                    ...prev,
                    workload: prev.workload.map(p => {
                        if (p.id !== projectId) return p;
                        switch(action) {
                            case 'accept': return { ...p, status: 'In Progress', statusColor: 'amber' };
                            case 'decline': return { ...p, status: 'Declined', statusColor: 'red' };
                            case 'pause': return { ...p, status: 'Paused', statusColor: 'gray' };
                            case 'resume': return { ...p, status: 'In Progress', statusColor: 'amber' };
                            case 'complete': return { ...p, status: 'Completed', statusColor: 'green', progress: 100 };
                            default: return p;
                        }
                    })
                }));
            };

            const handleRequestAdvance = (amount, reason) => {
                const newRequest = { id: Date.now(), amount, reason, status: 'Pending', date: new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric'}) };
                setUserDetails(prev => ({ ...prev, payments: { ...prev.payments, advanceRequests: [newRequest, ...prev.payments.advanceRequests] } }));
            };

            const handleAdvanceApproval = (requestId, amount) => {
                setUserDetails(prev => {
                    const newTransaction = { id: Date.now(), type: 'credit', description: `Advance Approved (ID: ${requestId})`, date: new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric'}), amount, status: 'Completed' };
                    return {
                        ...prev,
                        payments: {
                            ...prev.payments,
                            transactions: [newTransaction, ...prev.payments.transactions],
                            advanceRequests: prev.payments.advanceRequests.map(r => r.id === requestId ? { ...r, status: 'Approved' } : r)
                        }
                    };
                });
            };

            const handleWithdrawal = (amount) => {
                const newTransaction = { id: Date.now(), type: 'debit', description: 'Withdrawal to Bank', date: new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric'}), amount, status: 'Completed' };
                setUserDetails(prev => ({ ...prev, payments: { ...prev.payments, transactions: [newTransaction, ...prev.payments.transactions] } }));
            };
            
            const SidebarNav = ({ onLogout, activeView, setActiveView, setSidebarOpen }) => (
                 <nav className="flex-1 p-4 space-y-2">
                    <a href="#" onClick={(e) => { e.preventDefault(); setActiveView('dashboard'); setSidebarOpen(false);}} className={`flex items-center space-x-3 px-4 py-3 rounded-lg font-semibold ${activeView === 'dashboard' ? 'bg-blue-50 text-blue-700' : 'text-slate-600 hover:bg-slate-100'}`}> <Icon name="LayoutDashboard" /> <span>Dashboard</span> </a>
                    <a href="#" onClick={(e) => { e.preventDefault(); setActiveView('profile'); setSidebarOpen(false);}} className={`flex items-center space-x-3 px-4 py-3 rounded-lg font-semibold ${activeView === 'profile' ? 'bg-blue-50 text-blue-700' : 'text-slate-600 hover:bg-slate-100'}`}> <Icon name="UserCircle" /> <span>My Profile</span> </a>
                    <a href="#" onClick={onLogout} className="flex items-center space-x-3 px-4 py-3 rounded-lg font-semibold text-slate-600 hover:bg-slate-100"> <Icon name="LogOut" /> <span>Logout</span> </a>
                </nav>
            );

            return (
                <div className="page bg-slate-100 min-h-screen flex">
                    {modal.isOpen && modal.type === 'funds' && <ManageFundsModal user={userDetails} onClose={() => setModal({isOpen: false, type: null})} onWithdraw={handleWithdrawal} />}
                    {modal.isOpen && modal.type === 'advance' && <RequestAdvanceModal onClose={() => setModal({isOpen: false, type: null})} onRequest={handleRequestAdvance} />}

                    <div className={`fixed inset-0 z-40 md:hidden transition-transform transform ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'}`}>
                        <div className="absolute inset-0 bg-gray-800 opacity-75" onClick={() => setSidebarOpen(false)}></div>
                        <aside className="relative w-64 bg-white h-full shadow-md flex flex-col">
                            <div className="p-5 border-b flex justify-between items-center"> <Logo /> <button onClick={() => setSidebarOpen(false)}><Icon name="X" /></button> </div>
                            <SidebarNav onLogout={onLogout} activeView={activeView} setActiveView={setActiveView} setSidebarOpen={setSidebarOpen}/>
                        </aside>
                    </div>
                    <aside className="w-64 bg-white shadow-md flex-col hidden md:flex">
                        <div className="p-5 border-b"><Logo /></div>
                        <SidebarNav onLogout={onLogout} activeView={activeView} setActiveView={setActiveView} setSidebarOpen={setSidebarOpen} />
                    </aside>
                    <div className="flex-1 flex flex-col">
                        <header className="bg-white shadow-sm p-4 flex justify-between items-center">
                             <button onClick={() => setSidebarOpen(true)} className="md:hidden"> <Icon name="Menu" /> </button>
                            <div className="font-semibold text-xl hidden sm:block">Welcome back, {userDetails.name.split(' ')[0]}!</div>
                            <div className="flex items-center space-x-4">
                               <div className="relative"> <Icon name="Bell" className="text-slate-500" /> <span className="absolute -top-1 -right-1 flex h-3 w-3"> <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span className="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span> </span> </div>
                                <img src={userDetails.avatar} alt="User Avatar" className="w-10 h-10 rounded-full" />
                            </div>
                        </header>
                        <main className="flex-1 p-4 sm:p-6 md:p-8">
                            {activeView === 'profile' ? <ProfileView user={userDetails} /> : <DashboardView user={userDetails} onManageFunds={() => setModal({isOpen: true, type: 'funds'})} onRequestAdvance={() => setModal({isOpen: true, type: 'advance'})} onProjectAction={handleProjectAction} onAdvanceAction={handleAdvanceApproval} />}
                        </main>
                    </div>
                </div>
            );
        };
        
        const DashboardView = ({ user, onManageFunds, onRequestAdvance, onProjectAction, onAdvanceAction }) => {
            const overallBalance = user.payments.transactions.reduce((acc, curr) => curr.type === 'credit' ? acc + curr.amount : acc - curr.amount, 0);
            const newProjectsCount = user.workload.filter(p => p.status === 'New').length;

            const StatusPill = ({ color, text }) => {
                const colors = { green: 'bg-green-100 text-green-800', amber: 'bg-amber-100 text-amber-800', gray: 'bg-slate-200 text-slate-800', blue: 'bg-blue-100 text-blue-800', red: 'bg-red-100 text-red-800' };
                return <span className={`px-3 py-1 text-xs font-medium rounded-full ${colors[color]}`}>{text}</span>;
            };

            const BalanceCard = ({ balance, onManageFunds }) => {
                const isNegative = balance < 0;
                return (
                    <div className={`p-6 rounded-xl shadow-sm flex flex-col justify-between ${isNegative ? 'bg-red-50' : 'bg-green-50'}`}>
                        <div> <p className={`text-sm font-semibold ${isNegative ? 'text-red-700' : 'text-green-700'}`}> {isNegative ? 'Dues Pending' : 'Overall Balance'} </p> <p className={`text-3xl font-bold mt-1 ${isNegative ? 'text-red-800' : 'text-green-800'}`}> ₹{Math.abs(balance).toLocaleString('en-IN')} </p> </div>
                        <button onClick={onManageFunds} className={`mt-4 w-full font-semibold py-2 px-4 rounded-lg transition-colors ${isNegative ? 'bg-red-600 hover:bg-red-700 text-white' : 'bg-green-600 hover:bg-green-700 text-white'}`}> {isNegative ? 'Settle Dues' : 'Manage Funds'} </button>
                    </div>
                );
            };

            const ProjectActions = ({ project, onAction }) => {
                switch(project.status) {
                    case 'New': return ( <div className="flex space-x-2"> <button onClick={() => onAction(project.id, 'accept')} className="text-xs bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600">Accept</button> <button onClick={() => onAction(project.id, 'decline')} className="text-xs bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600">Decline</button> </div> );
                    case 'In Progress': return ( <div className="flex space-x-2"> <button onClick={() => onAction(project.id, 'pause')} className="text-xs bg-amber-500 text-white px-3 py-1 rounded-md hover:bg-amber-600">Pause</button> <button onClick={() => onAction(project.id, 'complete')} className="text-xs bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600">Complete</button> </div> );
                    case 'Paused': return ( <div className="flex space-x-2"> <button onClick={() => onAction(project.id, 'resume')} className="text-xs bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600">Resume</button> </div> );
                    default: return null;
                }
            };
            
            return (
            <div className="space-y-8">
                {/* Stat Cards */}
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <BalanceCard balance={overallBalance} onManageFunds={onManageFunds}/>
                    <div className="bg-white p-6 rounded-xl shadow-sm flex items-center space-x-4">
                        <div className="bg-blue-100 p-3 rounded-full"><Icon name="Briefcase" size={24} className="text-blue-600"/></div>
                        <div> <p className="text-slate-500 text-sm">Active Projects</p> <p className="text-2xl font-bold">{user.workload.filter(p => p.status === 'In Progress').length}</p> </div>
                    </div>
                    <div className="bg-white p-6 rounded-xl shadow-sm flex flex-col justify-center text-center">
                        <p className="text-slate-500 text-sm font-semibold">New Project Invitations</p>
                        <p className="text-3xl font-bold mt-1 text-blue-600">{newProjectsCount}</p>
                        <p className="text-xs text-slate-400 mt-1">Review them below</p>
                    </div>
                    <div className="bg-white p-6 rounded-xl shadow-sm flex flex-col justify-center items-center">
                        <button onClick={onRequestAdvance} className="w-full h-full flex flex-col items-center justify-center bg-slate-50 hover:bg-blue-50 rounded-lg transition-colors">
                            <Icon name="PlusCircle" size={32} className="text-blue-600" />
                            <p className="mt-2 font-semibold text-blue-700">Request Advance</p>
                        </button>
                    </div>
                </div>

                {/* Workload Section */}
                <div>
                    <h2 className="text-2xl font-bold mb-4">Project Management</h2>
                    <div className="bg-white p-6 rounded-xl shadow-sm">
                        <div className="space-y-4">
                        {user.workload.map((item) => (
                            <div key={item.id} className="border-b last:border-b-0 pb-4 last:pb-0">
                                <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-2"> <h3 className="font-semibold pr-4 mb-2 sm:mb-0">{item.name}</h3> <div className="flex items-center space-x-4"> <StatusPill color={item.statusColor} text={item.status} /> <ProjectActions project={item} onAction={onProjectAction} /> </div> </div>
                                {item.status !== 'New' && item.status !== 'Declined' && (
                                <>
                                <div className="flex justify-between items-center text-sm text-slate-500 mb-2"> <span>Due: {item.due}</span> <span>{item.progress}%</span> </div>
                                <div className="w-full bg-slate-200 rounded-full h-2.5"> <div className="bg-blue-600 h-2.5 rounded-full" style={{width: `${item.progress}%`}}></div> </div>
                                </>
                                )}
                            </div>
                        ))}
                        </div>
                    </div>
                </div>
                
                {/* Advance Requests Section */}
                {user.payments.advanceRequests.length > 0 && <div>
                    <h2 className="text-2xl font-bold mb-4">Advance Requests</h2>
                    <div className="bg-white rounded-xl shadow-sm overflow-x-auto">
                        <table className="w-full text-left">
                            <thead className="bg-slate-50 text-sm text-slate-600"> <tr> <th className="p-4 font-semibold">Date</th> <th className="p-4 font-semibold">Reason</th> <th className="p-4 font-semibold">Amount</th> <th className="p-4 font-semibold">Status</th> <th className="p-4 font-semibold">Action</th> </tr> </thead>
                            <tbody className="divide-y divide-slate-200">
                                {user.payments.advanceRequests.map(r => (
                                    <tr key={r.id} className="hover:bg-slate-50">
                                        <td className="p-4 text-slate-600">{r.date}</td>
                                        <td className="p-4 font-medium">{r.reason}</td>
                                        <td className="p-4 font-semibold">₹{r.amount.toLocaleString('en-IN')}</td>
                                        <td className="p-4"><StatusPill color={r.status === 'Approved' ? 'green' : 'amber'} text={r.status}/></td>
                                        <td className="p-4"> {r.status === 'Pending' && <button onClick={() => onAdvanceAction(r.id, r.amount)} className="text-xs bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600">Approve (Demo)</button>} </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>}

                {/* Transaction History Section */}
                <div>
                    <h2 className="text-2xl font-bold mb-4">Transaction History</h2>
                    <div className="bg-white rounded-xl shadow-sm overflow-x-auto">
                        <table className="w-full text-left">
                            <thead className="bg-slate-50 text-sm text-slate-600"> <tr> <th className="p-4 font-semibold">Description</th> <th className="p-4 font-semibold">Date</th> <th className="p-4 font-semibold">Status</th> <th className="p-4 font-semibold text-right">Amount (₹)</th> </tr> </thead>
                            <tbody className="divide-y divide-slate-200">
                                {user.payments.transactions.map(t => (
                                    <tr key={t.id} className="hover:bg-slate-50">
                                        <td className="p-4 font-medium">{t.description}</td>
                                        <td className="p-4 text-slate-600">{t.date}</td>
                                        <td className="p-4"><StatusPill color={t.status === 'Completed' ? 'green' : t.status === 'Processing' ? 'amber' : 'gray'} text={t.status}/></td>
                                        <td className={`p-4 font-bold text-right ${t.type === 'credit' ? 'text-green-600' : 'text-red-600'}`}> {t.type === 'credit' ? '+' : '-'} {t.amount.toLocaleString('en-IN')} </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        )};

        const ProfileView = ({ user }) => (
            <div className="bg-white p-6 md:p-8 rounded-xl shadow-sm">
                <div className="flex flex-col md:flex-row items-center md:items-start space-y-6 md:space-y-0 md:space-x-8 border-b pb-8 mb-8">
                    <img src={user.avatar} alt="Profile" className="w-32 h-32 rounded-full object-cover ring-4 ring-blue-100" />
                    <div className="text-center md:text-left flex-1">
                        <h1 className="text-3xl font-bold">{user.name}</h1> <p className="text-blue-600 font-semibold text-lg">{user.role}</p>
                        <div className="mt-4 flex flex-wrap justify-center md:justify-start gap-x-6 gap-y-2 text-slate-600">
                            <span className="flex items-center"><Icon name="Mail" size={16} className="mr-2"/> {user.email}</span>
                            <span className="flex items-center"><Icon name="Phone" size={16} className="mr-2"/> {user.phone}</span>
                            <span className="flex items-center"><Icon name="Badge" size={16} className="mr-2"/> ID: {user.employeeId}</span>
                        </div>
                    </div>
                </div>
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div className="lg:col-span-2"> <h2 className="text-2xl font-bold mb-4">About Me</h2> <p className="text-slate-600 leading-relaxed">{user.about}</p> </div>
                    <div>
                        <h2 className="text-2xl font-bold mb-4">Core Skills</h2>
                        <div className="space-y-4">
                        {user.skills.map(skill => (
                            <div key={skill.name}>
                                <div className="flex justify-between mb-1"> <span className="text-base font-medium text-slate-700">{skill.name}</span> <span className="text-sm font-medium text-slate-700">{skill.level}%</span> </div>
                                <div className="w-full bg-slate-200 rounded-full h-2.5"> <div className="bg-blue-600 h-2.5 rounded-full" style={{width: `${skill.level}%`}}></div> </div>
                            </div>
                        ))}
                        </div>
                    </div>
                </div>
            </div>
        );
        
        const ManageFundsModal = ({ user, onClose, onWithdraw }) => {
            const [amount, setAmount] = React.useState('');
            const [step, setStep] = React.useState('form'); // 'form', 'confirm', 'processing', 'done'
            const balance = user.payments.transactions.reduce((acc, curr) => curr.type === 'credit' ? acc + curr.amount : acc - curr.amount, 0);
            const isNegative = balance < 0;

            const handleWithdrawClick = () => { if(parseFloat(amount) > 0 && parseFloat(amount) <= balance) setStep('confirm'); };
            const handleConfirmWithdraw = () => { setStep('processing'); setTimeout(() => { onWithdraw(parseFloat(amount)); setStep('done'); }, 2000); };

            const renderContent = () => {
                switch(step) {
                    case 'confirm': return ( <div> <h3 className="text-lg font-semibold text-center">Confirm Withdrawal</h3> <p className="text-center text-slate-600 mt-2">You are about to withdraw <span className="font-bold">₹{parseFloat(amount).toLocaleString('en-IN')}</span> to your linked bank account.</p> <div className="bg-slate-50 p-4 rounded-lg mt-4 text-center"> <p className="font-semibold">{user.payments.bankAccount.name}</p> <p className="text-slate-500">{user.payments.bankAccount.number}</p> </div> <div className="mt-6 flex justify-end space-x-3"> <button onClick={() => setStep('form')} className="px-4 py-2 rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300">Cancel</button> <button onClick={handleConfirmWithdraw} className="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Confirm & Proceed</button> </div> </div> );
                    case 'processing': return ( <div className="text-center py-8"> <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div> <p className="mt-4 font-semibold text-slate-700">Processing your withdrawal...</p> <p className="text-sm text-slate-500">This may take a few moments.</p> </div> );
                    case 'done': return ( <div className="text-center py-8"> <Icon name="CheckCircle2" size={48} className="mx-auto text-green-500"/> <h3 className="text-xl font-semibold mt-4">Withdrawal Initiated!</h3> <p className="text-slate-600 mt-1">₹{parseFloat(amount).toLocaleString('en-IN')} is on its way to your account.</p> <button onClick={onClose} className="mt-6 w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Done</button> </div> );
                    default: // form
                        if (isNegative) return ( <div> <h3 className="text-xl font-bold text-red-600">Dues Pending</h3> <p className="text-slate-600 mt-1">You have a negative balance of <span className="font-semibold">₹{Math.abs(balance).toLocaleString('en-IN')}</span>. Please settle it to continue.</p> <div className="mt-4 p-4 text-center bg-slate-100 rounded-lg"> <p className="font-semibold">Scan QR to Pay</p> <img src={`https://placehold.co/200x200/fafafa/333?text=QR+Code`} alt="QR Code" className="mx-auto my-2 rounded-md" /> <p className="text-xs text-slate-500">Use any UPI app</p> </div> <button onClick={onClose} className="mt-6 w-full px-4 py-2 rounded-lg bg-slate-600 text-white hover:bg-slate-700">Close</button> </div> );
                        return ( <div> <h3 className="text-xl font-bold">Withdraw Funds</h3> <p className="text-slate-600 mt-1">Transfer your available balance to your bank account.</p> <div className="bg-slate-50 p-3 rounded-lg mt-4 flex justify-between items-center"> <div> <p className="text-sm font-semibold">{user.payments.bankAccount.name}</p> <p className="text-sm text-slate-500">{user.payments.bankAccount.number}</p> </div> <Icon name="CheckCircle" className="text-green-500" /> </div> <div className="mt-4"> <label htmlFor="amount" className="text-sm font-medium text-slate-700">Amount to withdraw (in ₹)</label> <input type="number" id="amount" value={amount} onChange={(e) => setAmount(e.target.value)} placeholder={`Max ₹${balance.toLocaleString('en-IN')}`} className="mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" /> </div> <button onClick={handleWithdrawClick} disabled={!amount || parseFloat(amount) <= 0 || parseFloat(amount) > balance} className="mt-6 w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed"> Withdraw ₹{amount ? parseFloat(amount).toLocaleString('en-IN') : '0'} </button> </div> );
                }
            };
            return ( <div className="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"> <div className="modal-content bg-white p-6 rounded-xl shadow-2xl w-full max-w-md relative"> <button onClick={onClose} className="absolute top-3 right-3 text-slate-400 hover:text-slate-600"> <Icon name="X" /> </button> {renderContent()} </div> </div> );
        };
        
        const RequestAdvanceModal = ({ onClose, onRequest }) => {
            const [amount, setAmount] = React.useState('');
            const [reason, setReason] = React.useState('');
            const [isSubmitting, setSubmitting] = React.useState(false);
            const [isDone, setDone] = React.useState(false);
            
            const handleSubmit = (e) => {
                e.preventDefault();
                setSubmitting(true);
                setTimeout(() => {
                    onRequest(parseFloat(amount), reason);
                    setSubmitting(false);
                    setDone(true);
                }, 1500);
            };

            if (isDone) {
                return ( <div className="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"> <div className="modal-content bg-white p-6 rounded-xl shadow-2xl w-full max-w-md relative text-center py-8"> <button onClick={onClose} className="absolute top-3 right-3 text-slate-400 hover:text-slate-600"> <Icon name="X" /> </button> <Icon name="CheckCircle2" size={48} className="mx-auto text-green-500"/> <h3 className="text-xl font-semibold mt-4">Request Sent!</h3> <p className="text-slate-600 mt-1">Your advance request has been submitted for approval.</p> <button onClick={onClose} className="mt-6 w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Done</button> </div> </div> );
            }

            return ( <div className="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"> <div className="modal-content bg-white p-6 rounded-xl shadow-2xl w-full max-w-md relative"> <button onClick={onClose} className="absolute top-3 right-3 text-slate-400 hover:text-slate-600"> <Icon name="X" /> </button> <h3 className="text-xl font-bold">Request an Advance</h3> <form onSubmit={handleSubmit} className="mt-4 space-y-4"> <div> <label htmlFor="adv-amount" className="text-sm font-medium text-slate-700">Amount (₹)</label> <input type="number" id="adv-amount" value={amount} onChange={(e) => setAmount(e.target.value)} placeholder="e.g., 5000" required className="mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"/> </div> <div> <label htmlFor="adv-reason" className="text-sm font-medium text-slate-700">Reason</label> <textarea id="adv-reason" value={reason} onChange={(e) => setReason(e.target.value)} placeholder="e.g., For project resources" required rows="3" className="mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"></textarea> </div> <button type="submit" disabled={!amount || !reason || isSubmitting} className="mt-2 w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-slate-400 flex items-center justify-center"> {isSubmitting ? <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div> : 'Submit Request'} </button> </form> </div> </div> );
        };

        window.onload = () => {
            ReactDOM.render(<App />, document.getElementById('root'));
        };
    </script>

</body>
</html>
